<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í”ì ì—†ëŠ” ê³ ë¯¼ ìƒë‹´ì†Œ | EMPTY</title>
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { 
            --main-brown: #8d7b68; 
            --soft-beige: #f9f7f2; 
            --accent: #e9967a;
        }

        * {
            font-family: 'Gowun Dodum', sans-serif !important;
            box-sizing: border-box; margin: 0; padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        body { 
            background-color: var(--soft-beige);
            color: #5d564e; min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            padding-bottom: 80px; /* ë‚´ë¹„ê²Œì´ì…˜ ë°” ê³µê°„ */
        }

        .main-wrapper {
            width: 100%; display: flex; flex-direction: column; gap: 15px; align-items: center;
            max-width: 500px; padding: 20px 0;
        }

        /* ê³µí†µ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .card { width: 92%; background: white; box-shadow: 0 8px 20px rgba(0,0,0,0.03); }

        /* [ìƒë‹¨ ë°°ë„ˆ] */
        .hero-section {
            width: 92%; height: 180px;
            background: linear-gradient(135deg, #a89685 0%, #8d7b68 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; text-align: center; border-radius: 40px; position: relative; 
        }
        .main-title { font-size: 1.6rem; font-weight: 700; }
        .sub-title { font-size: 0.8rem; letter-spacing: 5px; opacity: 0.7; }

        /* [ì„¹ì…˜ ì „í™˜] */
        .content-section { display: none; width: 100%; flex-direction: column; align-items: center; gap: 15px; }
        .content-section.active { display: flex; }

        /* [ê³ ë¯¼ ë¹„ìš°ê¸° ë·°] */
        .info-card { padding: 25px 15px; border-radius: 35px; display: flex; justify-content: space-around; align-items: center; }
        .info-label { font-size: 0.75rem; color: #bcab9a; margin-bottom: 5px; text-align: center; }
        .info-value { font-size: 1.4rem; font-weight: 700; color: var(--main-brown); text-align: center; }
        .temp-bar-bg { width: 80%; height: 5px; background: #f2f2f2; border-radius: 10px; margin: 10px auto 0; overflow: hidden; }
        .temp-bar-fill { height: 100%; background: var(--accent); transition: width 1.5s ease; }

        .input-card { padding: 40px 25px; border-radius: 40px; min-height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .emotion-selector { margin-bottom: 25px; display: flex; gap: 10px; }
        .emotion-btn { cursor: pointer; font-size: 2.4rem; filter: grayscale(1); opacity: 0.2; transition: 0.3s; }
        .emotion-btn.active { filter: grayscale(0); opacity: 1; transform: scale(1.1); }
        #content { width: 100%; height: 140px; border: none; background: transparent; font-size: 1.1rem; outline: none; resize: none; text-align: center; line-height: 1.7; }
        .btn-empty { background: var(--main-brown); color: white; border: none; padding: 16px 0; width: 100%; max-width: 260px; font-size: 1.2rem; font-weight: 700; border-radius: 50px; cursor: pointer; }

        /* [ì˜¨ê¸° ë‚˜ëˆ„ê¸° ë·°] */
        .warmth-list { width: 92%; display: flex; flex-direction: column; gap: 12px; }
        .warmth-card { background: white; padding: 20px; border-radius: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.02); border-left: 5px solid var(--accent); animation: fadeIn 0.5s ease; }
        .warmth-text { font-size: 1rem; line-height: 1.6; color: #5d564e; }
        .warmth-date { font-size: 0.7rem; color: #bcab9a; margin-top: 8px; display: block; }

        .warmth-input-card { padding: 25px; border-radius: 35px; margin-bottom: 10px; }
        #warmth-msg { width: 100%; height: 80px; border: 1px solid #eee; border-radius: 20px; padding: 15px; font-size: 0.95rem; outline: none; resize: none; margin-bottom: 15px; }
        .btn-share { background: var(--accent); color: white; border: none; padding: 12px 25px; border-radius: 30px; font-weight: 700; cursor: pointer; width: 100%; }

        /* [í•˜ë‹¨ ë‚´ë¹„ê²Œì´ì…˜] */
        .bottom-nav {
            position: fixed; bottom: 0; width: 100%; max-width: 500px; height: 70px;
            background: white; display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05); border-radius: 25px 25px 0 0; z-index: 100;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: #bcab9a; cursor: pointer; transition: 0.3s; }
        .nav-item.active { color: var(--main-brown); font-weight: 700; }
        .nav-icon { font-size: 1.4rem; margin-bottom: 4px; }
        .nav-label { font-size: 0.75rem; }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .burning { transform: scale(0.95); opacity: 0; filter: blur(15px); transition: 0.8s ease; }
    </style>
</head>
<body>

<div class="main-wrapper">
    <div class="hero-section">
        <h1 class="main-title">í”ì ì—†ëŠ” ê³ ë¯¼ ìƒë‹´ì†Œ</h1>
        <div class="sub-title">EMPTY</div>
    </div>

    <div id="section-burn" class="content-section active">
        <div class="card info-card">
            <div class="info-item">
                <div class="info-label">ë¹„ì›Œë‚¸ ë§ˆìŒ</div>
                <div class="info-value"><span id="total-val">0</span> ê°œ</div>
            </div>
            <div class="info-item">
                <div class="info-label">ë§ˆìŒì˜ ì˜¨ë„</div>
                <div class="info-value"><span id="temp-text">36.5</span>Â°C</div>
                <div class="temp-bar-bg"><div class="temp-bar-fill" id="temp-fill"></div></div>
            </div>
        </div>

        <div class="card input-card">
            <div id="input-view">
                <div class="emotion-selector">
                    <span class="emotion-btn active" onclick="selectEmotion(this, 'ğŸ˜')">ğŸ˜</span>
                    <span class="emotion-btn" onclick="selectEmotion(this, 'ğŸ˜°')">ğŸ˜°</span>
                    <span class="emotion-btn" onclick="selectEmotion(this, 'ğŸ˜¡')">ğŸ˜¡</span>
                    <span class="emotion-btn" onclick="selectEmotion(this, 'ğŸ˜±')">ğŸ˜±</span>
                    <span class="emotion-btn" onclick="selectEmotion(this, 'ğŸ’”')">ğŸ’”</span>
                </div>
                <textarea id="content" placeholder="ë²„ë¦¬ê³  ì‹¶ì€ ë§ˆìŒì„ ì´ê³³ì—&#10;í¸í•˜ê²Œ ì ì–´ë³´ì„¸ìš”..."></textarea>
                <button class="btn-empty" onclick="processBurn()">ë§ˆìŒ ë¹„ì›Œë‚´ê¸°</button>
            </div>
            <div id="quote-view" style="display:none; text-align: center;">
                <p id="quote-text" style="font-size: 1.3rem; line-height: 1.8; color: var(--main-brown); margin-bottom: 30px;"></p>
                <button onclick="resetView()" style="background:none; border:1px solid #eee; padding:10px 20px; border-radius:20px; color:#bcab9a; cursor:pointer;">ë‹¤ë¥¸ ê³ ë¯¼ ë¹„ìš°ê¸°</button>
            </div>
        </div>
    </div>

    <div id="section-warmth" class="content-section">
        <div class="card warmth-input-card">
            <p style="font-size: 0.9rem; color: #bcab9a; margin-bottom: 12px; text-align: center;">ëˆ„êµ°ê°€ì—ê²Œ í˜ì´ ë  í•œë§ˆë””ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.</p>
            <textarea id="warmth-msg" placeholder="ì˜ˆ) ì˜¤ëŠ˜ë„ ì •ë§ ìˆ˜ê³  ë§ì•˜ì–´ìš”. ë‹¹ì‹ ì€ ì¶©ë¶„íˆ ë¹›ë‚˜ëŠ” ì‚¬ëŒì´ì—ìš”."></textarea>
            <button class="btn-share" onclick="shareWarmth()">ì˜¨ê¸° ë‚˜ëˆ„ê¸°</button>
        </div>

        <div class="warmth-list" id="warmth-list">
            <div class="warmth-card">
                <p class="warmth-text">ë¹„ì›Œë‚¸ ê·¸ ìë¦¬ì— í–‰ë³µì´ ê°€ë“ ì±„ì›Œì§€ê¸¸ ë°”ë„ê²Œìš”. âœ¨</p>
                <span class="warmth-date">ë°©ê¸ˆ ì „</span>
            </div>
            <div class="warmth-card">
                <p class="warmth-text">ë‹¹ì‹ ì´ ê²ªëŠ” ëª¨ë“  ì¼ë“¤ì´ ê²°êµ­ ë‹¹ì‹ ì„ ë” ë‹¨ë‹¨í•˜ê²Œ ë§Œë“¤ì–´ ì¤„ ê±°ì˜ˆìš”. í˜ë‚´ì„¸ìš”!</p>
                <span class="warmth-date">10ë¶„ ì „</span>
            </div>
        </div>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('burn', this)">
        <span class="nav-icon">ğŸƒ</span>
        <span class="nav-label">ê³ ë¯¼ ë¹„ìš°ê¸°</span>
    </div>
    <div class="nav-item" onclick="switchTab('warmth', this)">
        <span class="nav-icon">ğŸ§¡</span>
        <span class="nav-label">ì˜¨ê¸° ë‚˜ëˆ„ê¸°</span>
    </div>
</div>

<script>
    let selectedEmotion = 'ğŸ˜';

    // íƒ­ ì „í™˜ ê¸°ëŠ¥
    function switchTab(section, el) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        
        document.getElementById('section-' + section).classList.add('active');
        el.classList.add('active');
    }

    // [ê¸°ì¡´] ê³ ë¯¼ ë¹„ìš°ê¸° ë¡œì§
    async function fetchInfo() {
        try {
            const res = await fetch('/info');
            const data = await res.json();
            document.getElementById('total-val').innerText = data.total;
            const tempVal = (36.5 + (data.total * 0.1)).toFixed(1);
            document.getElementById('temp-text').innerText = tempVal;
            document.getElementById('temp-fill').style.width = Math.min(tempVal, 100) + "%";
        } catch(e) {}
    }

    function selectEmotion(el, emo) {
        document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        selectedEmotion = emo;
    }

    async function processBurn() {
        const area = document.getElementById('content');
        if (!area.value.trim()) return;
        document.getElementById('input-view').classList.add('burning');
        
        const res = await fetch('/burn', { 
            method: 'POST', 
            body: new URLSearchParams({'content': area.value, 'emotion': selectedEmotion}) 
        });
        const data = await res.json();

        setTimeout(() => {
            document.getElementById('input-view').style.display = 'none';
            document.getElementById('quote-view').style.display = 'block';
            document.getElementById('quote-text').innerText = data.quote;
            fetchInfo();
        }, 800);
    }

    function resetView() {
        document.getElementById('content').value = "";
        document.getElementById('input-view').classList.remove('burning');
        document.getElementById('input-view').style.display = 'block';
        document.getElementById('quote-view').style.display = 'none';
    }

    // [ì‹ ê·œ] ì˜¨ê¸° ë‚˜ëˆ„ê¸° ë¡œì§
    function shareWarmth() {
        const msgArea = document.getElementById('warmth-msg');
        const text = msgArea.value.trim();
        if(!text) return;

        const list = document.getElementById('warmth-list');
        const newMsg = document.createElement('div');
        newMsg.className = 'warmth-card';
        newMsg.innerHTML = `<p class="warmth-text">${text}</p><span class="warmth-date">ë°©ê¸ˆ ì „</span>`;
        
        list.prepend(newMsg); // ìµœì‹ ê¸€ì´ ìœ„ë¡œ
        msgArea.value = "";
        alert("ë‹¹ì‹ ì˜ ì˜¨ê¸°ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ§¡");
    }

    window.onload = fetchInfo;
</script>
</body>
</html>